version: '3'
name: OCSF_to_CEF_Convert
description: Convert OCSF format to CEF
groups:
  - name: CEF_Conversion
    description: Convert AWS OCSF to CEF format
    functions:
      - id: Eval_Fields
        type: Eval
        conf:
          expressions:
            cef_version: '"CEF:0"'
            device_vendor: '"AWS"'
            device_product: metadata.product.name
            device_version: metadata.product.version
            signature_id: metadata.event_code
            name: api.name
            severity: tostring(severity.id)
            act: api.name
            rt: tostring(time)
            src: actor.invoked_by
            dvc: cloud.region
            suser: actor.user.uid
            cs1Label: '"EventCode"'
            cs1: metadata.event_code
            cs2Label: '"Type"'
            cs2: type_name
            cs3Label: '"Status"'
            cs3: api.status
      - id: Serialize_to_CEF
        type: Eval
        conf:
          expressions:
            _raw: |
              cef_version + "|" +
              device_vendor + "|" +
              device_product + "|" +
              device_version + "|" +
              signature_id + "|" +
              name + "|" +
              severity + "|" +
              "act=" + act + " rt=" + rt + " src=" + src + " dvc=" + dvc + " suser=" + suser +
              " cs1Label=" + cs1Label + " cs1=" + cs1 + 
              " cs2Label=" + cs2Label + " cs2=" + cs2 + 
              " cs3Label=" + cs3Label + " cs3=" + cs3
